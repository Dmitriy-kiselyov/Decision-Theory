# Plug-in

### Теория

**Plug-in** - байесовский алгоритм классификации, в котором в качестве
моделей восстанавливаемых плотностей рассматривают многомерные
<u>нормальные плотности</u>:

![](http://latex.codecogs.com/svg.latex?N%28x%3B%5Cmu%2C%5CSigma%29%20%3D%20%5Cfrac%7B1%7D%7B%5Csqrt%7B%282%5Cpi%29%5En%20%7C%5CSigma%7C%7D%7D%20%5Ccdot%20exp%5Cleft%28-%5Cfrac%7B1%7D%7B2%7D%28x%20-%20%5Cmu%29%5ET%20%5CSigma%5E%7B-1%7D%20%28x%20-%20%5Cmu%29%5Cright%29),

где ![](http://latex.codecogs.com/svg.latex?x%20%5Cin%20%5Cmathbb%7BR%7D%5En)
– объект выборки, имеющий *n* признаков,
![](http://latex.codecogs.com/svg.latex?%5Cmu%20%5Cin%20%5Cmathbb%7BR%7D%5En)
– математическое ожидание (центр выборки),
![](http://latex.codecogs.com/svg.latex?%5CSigma%20%5Cin%20%5Cmathbb%7BR%7D%5E%7Bn%20%5Ctimes%20n%7D)
– ковариационная матрица (симметричная, невырожденная, положительно
определенная).

Восстанавливая параметры
![](http://latex.codecogs.com/svg.latex?%5Cmu%2C%20%5CSigma)
для каждого класса и подставляя в оптимальный байесовский
классификатор получаем **plug-in**.

Эти параметри оцениваются по следующим формулам:

![](http://latex.codecogs.com/svg.latex?%5Chat%7B%5Cmu%7D%20%3D%20%5Cfrac%7B1%7D%7Bm%7D%20%24%24%5Csum_%7Bi%20%3D%201%7D%5E%7Bm%7D%20x_i%24%24)

![](http://latex.codecogs.com/svg.latex?%5Chat%7B%5CSigma%7D%20%3D%20%5Cfrac%7B1%7D%7Bm%20-%201%7D%20%24%24%5Csum_%7Bi%20%3D%201%7D%5E%7Bm%7D%20%28x_i%20-%20%5Chat%7B%5Cmu%7D%29%28x_i%20-%20%5Chat%7B%5Cmu%7D%29%5ET),

которые выполняются для объектов каждого класса,
где *m* – количество объектов в данном классе.

### Программная реализация

Исходный код программы: [Plug-in/server.R](../Plug-in/server.R)

На основе данных:

- размеров классов
- мат. ожидания (смещение по _х_ и _y_)
- ковариационной матрицы (растяжение по _x_ и _y_)

программа генирирует объекты из
![](http://latex.codecogs.com/svg.latex?%5Cmathbb%7BR%7D%5E2)
для двух классов с <u>нормально распределенными параметрами</u>.

После по полученным выборкам строятся новые
![](http://latex.codecogs.com/svg.latex?%5Chat%7B%5Cmu%7D)
и
![](http://latex.codecogs.com/svg.latex?%5Chat%7B%5CSigma%7D),
и между классами проводится *разделяющая поверхность*.

### Результат

Программа реализована с помощью библиотеки *shiny*, которая реализует
интерфейс для задания параметров. Так что параметры пользователю
предлагается выбрать самому.

Программа доступна по
[ссылке](https://dmitriypenetrator.shinyapps.io/plug-in/)

Некоторые примеры:

1) Если признаки _некоррелированы_, линии уровня плотности распределения
имеют форму элипсоидов с центром в точке
![](http://latex.codecogs.com/svg.latex?%5Chat%7B%5Cmu%7D)
и параллельны осям координат.

![](pict/Plug-in_1.png)

2) Если признаки имею одинаковые дисперсии, то элипсоиды являются сферами

![](pict/Plug-in_2.png)

3) Пример, когда менее плотный класс окружен более плотным

![](pict/Plug-in_3.png)

Это простые примеры, для которых __Plug-in__ хорошо работает, однако
на более сложных выборках он показывает неудовлетворительные результаты.
В частности:

- Классы, которые распадаются на изолированные сгустки
- Если присутствуют линейно зависимые признаки, матрица становится
вырожденной и решений алгоритм не дает
- Если признаки почти линейно зависимы, матрица _плохо обусловлена_ и
алгоритм дает большие погрешности

----

[Вернуться в меню](../../README.md)

[Сравнить с Линейным дискриминантом Фишера](fisher.md)

