# Линейный дискриминант Фишера

### Теория

**ЛДФ** - байесовский алгоритм классификации, который основан на алгоритме
**plug-in** с новым предположением:
<u>ковариационные матрицы классов равны</u>.
В случае, когда это условие действительно выполняется, **ЛДФ** показывает
себя лучше **plug-in** алгоритма, а сам алгоритм стовится более прозрачным.

Если ковариационные матрицы классов равны, в таком случае мы можем оценить
![](http://latex.codecogs.com/svg.latex?%5Chat%7B%5CSigma%7D)
по всем _l_ объектам выборки:

![](http://latex.codecogs.com/svg.latex?%5Chat%7B%5CSigma%7D%20%3D%20%5Cfrac%7B1%7D%7Bl%20-%20%7CY%7C%7D%20%5Ccdot%20%5Csum_%7Bi%3D1%7D%5E%7Bl%7D%28x_i%20-%20%5Chat%7B%5Cmu%7D_y_i%29%28x_i%20-%20%5Chat%7B%5Cmu%7D_y_i%29%5ET)

Так как матрицы равны, то по _теореме о квадратичном дискриминанте_,
разделяющая поверхность линейна, и представляет собой уравнение вида:

![](http://latex.codecogs.com/svg.latex?%5Calpha_yx%5ET%20&plus;%20%5Cbeta_y%20%3D%200),
где

![](http://latex.codecogs.com/svg.latex?%5Calpha_y%20%3D%20%5CSigma%5E%7B-1%7D%20%5Chat%7B%5Cmu%7D_y)

![](http://latex.codecogs.com/svg.latex?%5Cbeta_y%20%3D%20%5Cln%28%5Clambda_yP_y%29%20-%5Cfrac%7B1%7D%7B2%7D%20%5Chat%7B%5Cmu%7D_y%5ET%20%5CSigma%5E%7B-1%7D%20%5Chat%7B%5Cmu%7D_y)

### Программная реализация

Исходный код программы: [Fisher/server.R](../Fisher/server.R)

На основе данных:

- размеров классов
- мат. ожидания (смещение по _х_ и _y_)
- ковариационной матрицы (растяжение по _x_ и _y_)

программа генирирует объекты из
![](http://latex.codecogs.com/svg.latex?%5Cmathbb%7BR%7D%5E2)
для двух классов с <u>нормально распределенными параметрами</u>.

<u>Отличие от **plug-in** в том, что матрица общая на 2 класса,
как того требует условие **ЛДФ**</u>.

После по полученным выборкам строятся новые
![](http://latex.codecogs.com/svg.latex?%5Chat%7B%5Cmu%7D)
и
![](http://latex.codecogs.com/svg.latex?%5Chat%7B%5CSigma%7D),
и между классами проводится *разделяющая поверхность*.

### Результат

Программа реализована с помощью библиотеки *shiny*, которая реализует
интерфейс для задания параметров. Так что параметры пользователю
предлагается выбрать самому.

Программа доступна по
[ссылке](https://dmitriypenetrator.shinyapps.io/fisher/)

Сравним результаты классификации **plug-in** и **ЛДФ**
при одинаковых данных: 

1) Дисперсии признаков обоих классов одинаковы:

![](pict/fisher_1.png)

![](pict/plug-in_fisher_1.png)

2) Дисперсии одинаковы, мало объектов в классах:

![](pict/fisher_2.png)

![](pict/plug-in_fisher_2.png)

3) Дисперсии разные

![](pict/fisher_3.png)

![](pict/plug-in_fisher_3.png)

Из сравнения видно, что **ЛДФ** справляется с задачей классификации
гораздо лучше, чем его соперник. Разделяющая поверхность **ЛДФ**
всегда остается прямой (что удовлетворяет теореме), а **plug-in**
часто выраждается в параболу. И ковариационная матрица **ЛДФ**
отклоняется от исходной меньше, чем матрица **plug-in**.
Причем, чем "жестче" условия классификации,
тем выгодней смотрится **ЛДФ**.

Недостатком ЛДФ можно назвать узкую сферу его применения.
Классы должны быть очень похожи друг на друга для удовлетворительной
классификации.

----

[Вернуться в меню](../../README.md)

[Вернуться к Подстановочнуму алгортиму](plug-in.md)

